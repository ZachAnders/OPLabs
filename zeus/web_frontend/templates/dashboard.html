{% extends "base.html" %}

{% block body %}

<script>

CSRF_TOKEN = "{{csrf_token()}}"

function reload() {
    location.reload()
}

function delete_rec(row_id) {
    $.ajax({
        type: "POST",
        url: "/api/delete_result",
        data: {"test_id" : row_id,
        "_csrf_token": CSRF_TOKEN },
        success: reload,
        error: reload
    });
}

</script>

<h2> Your tests run </h2>

<br>

<table class="table table-striped">
    <tr>
        <th> Device IP </th>
        <th> Device Type </th>
        <th> Device Status </th>
        <th> Delete </th>
    </tr>
    {% for test_set in user_sets %}
    {% for result in test_set.tests %}
    <tr>
        <td>  {{ result.device_ip }}  </td>
        <td>  {{ result.device_type }}  </td>
        {% if result.device_state == "wait" %}
        <td> Message Pending </td>
        {% elif result.device_state == "ack" %}
        <td> Message Acknowledged </td>
        {% else %}
        <td> Unknown </td>
        {% endif %}
        <td>
            <button type="button" class="btn btn-danger" onclick="delete_rec({{result.test_id}})"> Delete </button>
        </td>
    </tr>
    {% endfor %}
    {% endfor %}

</table>


{% endblock %}
